<!DOCTYPE html>
<html>
<head>
    <script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>
    <h2>Pie Chart</h2>
    <svg width="500" height="400"></svg> <!--Step 2-->
    <script>
        
        var svg = d3.select("svg"),
            width = svg.attr("width"),
            height = svg.attr("height"),
            radius = 200;

var data = [
  {
    "maladie": "Asthmatique",
    "intervales_ages": "<=18",
    "femme_Non_active": "0",
    "femme_Oui_active": "1",
    "homme_Non_actif": "1",
    "homme_Oui_actif": "0"
  },
  {
    "maladie": "Asthmatique",
    "intervales_ages": "18-25",
    "femme_Non_active": "2",
    "femme_Oui_active": "0",
    "homme_Non_actif": "0",
    "homme_Oui_actif": "1"
  },
  {
    "maladie": "Asthmatique",
    "intervales_ages": "25-45",
    "femme_Non_active": "0",
    "femme_Oui_active": "2",
    "homme_Non_actif": "0",
    "homme_Oui_actif": "1"
  },
  {
    "maladie": "Asthmatique",
    "intervales_ages": "45-70",
    "femme_Non_active": "0",
    "femme_Oui_active": "0",
    "homme_Non_actif": "0",
    "homme_Oui_actif": "0"
  },
  {
    "maladie": "Diabete",
    "intervales_ages": "<=18",
    "femme_Non_active": "2",
    "femme_Oui_active": "1",
    "homme_Non_actif": "0",
    "homme_Oui_actif": "0"
  },
  {
    "maladie": "Diabete",
    "intervales_ages": "18-25",
    "femme_Non_active": "3",
    "femme_Oui_active": "2",
    "homme_Non_actif": "7",
    "homme_Oui_actif": "1"
  },
  {
    "maladie": "Diabete",
    "intervales_ages": "25-45",
    "femme_Non_active": "3",
    "femme_Oui_active": "3",
    "homme_Non_actif": "3",
    "homme_Oui_actif": "3"
  },
  {
    "maladie": "Diabete",
    "intervales_ages": "45-70",
    "femme_Non_active": "0",
    "femme_Oui_active": "1",
    "homme_Non_actif": "1",
    "homme_Oui_actif": "0"
   },
   {
    "maladie": "Tension",
    "intervales_ages": "<=18",
    "femme_Non_active": "0",
    "femme_Oui_active": "1",
    "homme_Non_actif": "1",
    "homme_Oui_actif": "0"
  },
  {
    "maladie": "Tension",
    "intervales_ages": "18-25",
    "femme_Non_active": "6",
    "femme_Oui_active": "4",
    "homme_Non_actif": "4",
    "homme_Oui_actif": "4"
  },
  {
    "maladie": "Tension",
    "intervales_ages": "25-45",
    "femme_Non_active": "2",
    "femme_Oui_active": "1",
    "homme_Non_actif": "4",
    "homme_Oui_actif": "2"
  },
  {
    "maladie": "Tension",
    "intervales_ages": "45-70",
    "femme_Non_active": "0",
    "femme_Oui_active": "0",
    "homme_Non_actif": "0",
    "homme_Oui_actif": "0"
  }
];

        
        var g = svg.append("g")
                   .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

        // Step 4
        var ordScale = d3.scaleOrdinal()
                          .domain(data)
                          .range(['#ffd384','#94ebcd','#fbaccc','#d3e0ea']);

        // Step 5
        var pie = d3.pie().value(function(d) { 
                console.log([parseInt(d.femme_Non_active),parseInt(d.femme_Oui_active),parseInt(d.homme_Non_actif),parseInt(d.homme_Oui_actif)]);
                return [parseInt(d.femme_Non_active),parseInt(d.femme_Oui_active),parseInt(d.homme_Non_actif),parseInt(d.homme_Oui_actif)]; 
            });

        var arc = g.selectAll("arc")
                   .data(pie(data))
                   .enter();

        // Step 6
        var path = d3.arc()
                     .outerRadius(radius)
                     .innerRadius(0);

        arc.append("path")
           .attr("d", path)
           .attr("fill", function(d) { return ordScale([d.data.maladie,d.data.intervales_ages]); });

        // Step 7
        var label = d3.arc()
                      .outerRadius(radius)
                      .innerRadius(0);
            
        arc.append("text")
           .attr("transform", function(d) { 
                    return "translate(" + label.centroid(d) + ")"; 
            })
           .text(function(d) { return d.data.maladie+" entre "+d.data.intervales_ages; })
           .style("font-family", "arial")
           .style("font-size", 15);
            

            
    </script>
</body>
</html>